<!doctype html><html lang=en><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge,chrome=1"><title>Wargames 2 - COMP6447 Musings</title><meta name=renderer content=webkit><meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=1"><meta http-equiv=cache-control content=no-transform><meta http-equiv=cache-control content=no-siteapp><meta name=theme-color content=#f8f5ec><meta name=msapplication-navbutton-color content=#f8f5ec><meta name=apple-mobile-web-app-capable content=yes><meta name=apple-mobile-web-app-status-bar-style content=#f8f5ec><meta name=author content=z5206677><meta name=description content="jump [Binary]"><meta name=keywords content=Hugo,theme,even><meta name=generator content="Hugo 0.58.2 with theme even"><link rel=canonical href=../../../post/wargames/war2/><link rel=apple-touch-icon sizes=180x180 href=../../../apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=../../../favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=../../../favicon-16x16.png><link rel=manifest href=../../../manifest.json><link rel=mask-icon href=../../../safari-pinned-tab.svg color=#5bbad5><link href=../../../dist/even.c2a46f00.min.css rel=stylesheet><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.1.20/dist/jquery.fancybox.min.css integrity="sha256-7TyXnr2YU040zfSP+rEcz29ggW4j56/ujTPwjMzyqFY=" crossorigin=anonymous><link rel=stylesheet href=../../../css/typedjs.shortcode.css><meta property=og:title content="Wargames 2"><meta property=og:description content="jump [Binary]"><meta property=og:type content=article><meta property=og:url content=/post/wargames/war2/><meta property=article:published_time content=2020-06-08T12:00:00+10:00><meta property=article:modified_time content=2020-06-08T12:00:00+10:00><meta itemprop=name content="Wargames 2"><meta itemprop=description content="jump [Binary]"><meta itemprop=datePublished content=2020-06-08T12:00:00&#43;10:00><meta itemprop=dateModified content=2020-06-08T12:00:00&#43;10:00><meta itemprop=wordCount content=422><meta itemprop=keywords content><meta name=twitter:card content=summary><meta name=twitter:title content="Wargames 2"><meta name=twitter:description content="jump [Binary]"><!--[if lte IE 9]><script src=https://cdnjs.cloudflare.com/ajax/libs/classlist/1.1.20170427/classList.min.js></script><![endif]--><!--[if lt IE 9]><script src=https://cdn.jsdelivr.net/npm/html5shiv@3.7.3/dist/html5shiv.min.js></script><script src=https://cdn.jsdelivr.net/npm/respond.js@1.4.2/dest/respond.min.js></script><![endif]--></head><body><div id=mobile-navbar class=mobile-navbar><div class=mobile-header-logo><a href=../../../ class=logo>COMP6447 Musings</a></div><div class=mobile-navbar-icon><span></span><span></span><span></span></div></div><nav id=mobile-menu class="mobile-menu slideout-menu"><ul class=mobile-menu-list><a href=../../../><li class=mobile-menu-item>Home</li></a><a href=https://github.com/featherbear/UNSW-COMP6447><li class=mobile-menu-item>GitHub</li></a><a href=../../../categories/><li class=mobile-menu-item>Categories</li></a></ul></nav><div class=container id=mobile-panel><header id=header class=header><div class=logo-wrapper><a href=../../../ class=logo>COMP6447 Musings</a></div><nav class=site-navbar><ul id=menu class=menu><li class=menu-item><a class=menu-item-link href=../../../>Home</a></li><li class=menu-item><a class=menu-item-link href=https://github.com/featherbear/UNSW-COMP6447>GitHub</a></li><li class=menu-item><a class=menu-item-link href=../../../categories/>Categories</a></li></ul></nav></header><main id=main class=main><div class=content-wrapper><div id=content class=content><article class=post><header class=post-header><h1 class=post-title>Wargames 2</h1><div class=post-meta><span class=post-time>2020-06-08</span><div class=post-category><a href=../../../categories/wargames/>Wargames</a></div></div></header><div class=post-toc id=post-toc><h2 class=post-toc-title>Contents</h2><div class="post-toc-content always-active"><nav id=TableOfContents><ul><li><ul><li><a href=#jump>jump</a><ul><li><a href=#scenario>Scenario</a></li><li><a href=#solution>Solution</a></li></ul></li><li><a href=#blind>blind</a><ul><li><a href=#scenario-1>Scenario</a></li><li><a href=#solution-1>Solution</a></li></ul></li><li><a href=#best-security>Best Security</a><ul><li><a href=#scenario-2>Scenario</a></li><li><a href=#solution-2>Solution</a></li></ul></li><li><a href=#stack-dump>Stack Dump</a><ul><li><a href=#scenario-3>Scenario</a></li><li><a href=#solution-3>Solution</a></li></ul></li><li><a href=#reverse-engineering>Reverse Engineering</a></li></ul></li></ul></nav></div></div><div class=post-content><h2 id=jump>jump</h2><p>[<a href=https://github.com/featherbear/UNSW-COMP6447/raw/master/wargames/week2/jump>Binary</a>]<br>[<a href=https://github.com/featherbear/UNSW-COMP6447/raw/master/wargames/week2/solve-jump.py>Solution</a>]</p><h3 id=scenario>Scenario</h3><p>The function address for the win function is given to us, which we need to execute somehow.</p><h3 id=solution>Solution</h3><p>We need to override the function pointer variable (<code>ebp - 0x8</code>) through the <code>gets</code> call. The distance between memory addresses of the function pointer variable and the string buffer (<code>ebp - 0x48</code>) is <code>0x40</code> bytes.<br>We should send 0x40 bytes of pad followed by the address of the win function.</p><hr><h2 id=blind>blind</h2><p>[<a href=https://github.com/featherbear/UNSW-COMP6447/raw/master/wargames/week2/blind>Binary</a>]<br>[<a href=https://github.com/featherbear/UNSW-COMP6447/raw/master/wargames/week2/solve-blind.py>Solution</a>]</p><h3 id=scenario-1>Scenario</h3><p>A binary is given, without any immediately visible indicators.</p><h3 id=solution-1>Solution</h3><p>Looking at the disassembly of the binary, there is a <code>win</code> function (<code>0x80484d6</code>), and a <code>vuln</code> function that is called by main. A <code>gets</code> call stores data into <code>ebp - 0x44</code> / <code>esp - 0x48</code>. We can perform a buffer overflow with <code>0x48</code> bytes of padding to modify the return address of <code>vuln</code> to our <code>win</code> function.</p><hr><h2 id=best-security>Best Security</h2><p>[<a href=https://github.com/featherbear/UNSW-COMP6447/raw/master/wargames/week2/bestsecurity>Binary</a>]<br>[<a href=https://github.com/featherbear/UNSW-COMP6447/raw/master/wargames/week2/solve-bestsecurity.py>Solution</a>]</p><h3 id=scenario-2>Scenario</h3><p>A fixed-value stack canary of &ldquo;1234&rdquo; is hardcoded into the binary.</p><h3 id=solution-2>Solution</h3><p>The value of the canary is stored in <code>ebp - 0x5</code>, and the <code>gets</code> buffer is pointed to <code>ebp - 0x85</code>.<br>We need to pad <code>0x80</code> bytes, then send &ldquo;1234&rdquo; in order to override the canary.</p><hr><h2 id=stack-dump>Stack Dump</h2><p>[<a href=https://github.com/featherbear/UNSW-COMP6447/raw/master/wargames/week2/stack-dump>Binary</a>]<br>[<a href=https://github.com/featherbear/UNSW-COMP6447/raw/master/wargames/week2/solve-stack-dump.py>Solution</a>]</p><h3 id=scenario-3>Scenario</h3><p>The given binary file initialises a random-valued stack canary.<br>When the quit function is called, the program checks if the stack canary has changed or not - crashing if it has.</p><h3 id=solution-3>Solution</h3><p>Through the given functions we need to override the return address to the win function, whilst maintaining the correct canary value.</p><ul><li>Buffer at <code>ebp - 0x68</code></li><li>Canary at <code>ebp - 0x8</code></li><li>Win function at <code>0x80486c6</code></li></ul><p>The stack pointer is revealed to us as the start of the program.<br>Upon analysing the binary, we find that <code>esp = ebp - 0x71</code>.<br>Likewise, <code>ebp = esp + 0x71</code></p><p>We can leak the canary (`ebp - 0x8) by writing the address of the canary through the input data function, then calling the dump memory function. Once we have the canary, we can overflow the buffer with padding, the canary value, more padding and the win function address.</p><p>When the quit function is called, our buffer overflow ensures that the canary is the correct value, and hence proceeds and returns to our win function.</p><hr><h2 id=reverse-engineering>Reverse Engineering</h2><p>[<a href=https://github.com/featherbear/UNSW-COMP6447/raw/master/wargames/week2/chall1.png>Disassembly</a>]<br>[<a href=https://github.com/featherbear/UNSW-COMP6447/raw/master/wargames/week2/chall1.c>Solution</a>]</p><p>The function <code>main</code> performs a <code>scanf</code> call, which an the integer into the variable at address <code>ebp - 0xc</code>. This value is then compared to <code>0x539</code> (1337), which if true prints out <em>&ldquo;Your so leet!&rdquo;</em>, else <em>&ldquo;Bye&rdquo;</em>. The program returns with the status code <code>1</code></p></div><footer class=post-footer><nav class=post-nav><a class=prev href=../../../post/tutorials/tutorial1/><i class="iconfont icon-left"></i><span class="prev-text nav-default">Tutorial 1</span>
<span class="prev-text nav-mobile">Prev</span></a>
<a class=next href=../../../post/memory-x86/><span class="next-text nav-default">Memory in x86 Systems</span>
<span class="next-text nav-mobile">Next</span>
<i class="iconfont icon-right"></i></a></nav></footer></article></div></div></main><footer id=footer class=footer><div class=social-links><a href=mailto:z5206677@student.unsw.edu.au class="iconfont icon-email" title=email></a><a href=https://www.linkedin.com/in/andrewjinmengwong/ class="iconfont icon-linkedin" title=linkedin></a><a href=https://github.com/featherbear class="iconfont icon-github" title=github></a><a href=https://www.instagram.com/_andrewjwong/ class="iconfont icon-instagram" title=instagram></a><a href=../../../index.xml type=application/rss+xml class="iconfont icon-rss" title=rss></a></div><div class=copyright><span class=power-by>Powered by <a class=hexo-link href=https://gohugo.io>Hugo</a></span>
<span class=division>|</span>
<span class=theme-info>Theme -
<a class=theme-link href=https://github.com/olOwOlo/hugo-theme-even>Even</a></span>
<span class=copyright-year>&copy;
2020
<span class=heart><i class="iconfont icon-heart"></i></span><span class=author>Andrew Wong (z5206677)</span></span></div></footer><div class=back-to-top id=back-to-top><i class="iconfont icon-up"></i></div></div><script src=https://cdn.jsdelivr.net/npm/jquery@3.2.1/dist/jquery.min.js integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4=" crossorigin=anonymous></script><script src=https://cdn.jsdelivr.net/npm/slideout@1.0.1/dist/slideout.min.js integrity="sha256-t+zJ/g8/KXIJMjSVQdnibt4dlaDxc9zXr/9oNPeWqdg=" crossorigin=anonymous></script><script src=https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.1.20/dist/jquery.fancybox.min.js integrity="sha256-XVLffZaxoWfGUEbdzuLi7pwaUJv1cecsQJQqGLe7axY=" crossorigin=anonymous></script><script type=text/javascript src=../../../dist/even.26188efa.min.js></script><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;ga('create','UA-107434487-2','auto');ga('send','pageview');}</script><script async src=https://www.google-analytics.com/analytics.js></script><script src=../../../js/typed.js@2.0.9></script><script src=../../../js/typedjs.shortcode.js></script></body></html>